import{_ as C,B as P,C as S,j as D,r as d,o as A,a as c,b as y,d as s,s as N,v as r,x as n,z as B,t as I,m as $,F as j,i as b}from"./index-D7EuPnGH.js";const z={class:"profile-container"},F={class:"side-and-main"},T={class:"second-grid"},O={class:"profile-management-content"},R={class:"info-group1"},q=["value"],G={class:"info-group2"},H={class:"inline"},J={class:"info-group1"},K={class:"info-group1"},L={class:"info-group1"},Q={class:"info-group2"},W={class:"inline"},X={class:"address-group"},Y={class:"inline"},Z=["value"],ss={key:0,id:"pw-change-modal-container",class:"modal-container"},es={class:"pw-change-modal"},os={class:"input-container"},as={class:"input-group"},ts={class:"input-group"},ls={class:"input-group"},rs={__name:"UserInfoView",setup(ns){const w=P(),u=S(),g=D(),i=d(0),o=d({userUuid:"",password:"",userName:"",phone:"",birthDate:"",email:"",address:"",detailAddress:""});A(async()=>{console.log("유저정보",g.user),i.value=g.user.userId,console.log("유저ID : ",i.value);try{const t=await c.get(`http://localhost:8081/api/v1/userinfo/${i.value}`);Object.assign(o.value,t.data)}catch(t){console.error("Error loading user data:",t)}});const f=d(!1),m=d(""),p=d(""),v=d(""),M=()=>{console.log("비밀번호 변경 버튼 클릭됨"),f.value=!0},h=()=>{f.value=!1},k=async()=>{if(p.value!==v.value){u.showModal("개인정보수정","비밀번호 오류","새 비밀번호가 일치하지 않습니다.","확인");return}try{await c.post(`http://localhost:8081/api/v1/userinfo/${i.value}/change-password`,{currentPassword:m.value,newPassword:p.value,confirmNewPassword:v.value}),w.showModal("개인정보수정","비밀번호가 성공적으로 변경되었습니다."),h(),m.value="",p.value="",v.value=""}catch(t){console.error("Error updating password:",t),u.showModal("개인정보수정","비밀번호 오류","비밀번호 변경에 실패했습니다.","확인")}},U=async()=>{try{await c.put(`http://localhost:8081/api/v1/userinfo/${i.value}`,o.value),w.showModal("개인정보수정","회원정보를 성공적으로 업데이트했습니다.")}catch(t){console.error("Error updating profile:",t),u.showModal("개인정보수정","개인정보 수정 오류","회원정보 업데이트에 실패했습니다.","확인")}},l=d({message:"",isError:!1}),E=async()=>{if(!o.value.email){l.value.message="이메일을 입력해주세요.",l.value.isError=!0;return}console.log("이메일 중복 확인 요청: ",o.value.email);try{const t=await c.get("http://localhost:8081/api/v1/userinfo/check-email",{params:{email:o.value.email}});console.log(t.data),t.data.exists===!0?(l.value.message="이미 사용 중인 이메일입니다.",l.value.isError=!0):(l.value.message="사용 가능한 이메일입니다.",l.value.isError=!1)}catch(t){console.error("Error checking email:",t),l.value.message="이메일 중복 확인에 실패했습니다.",l.value.isError=!0}},V=()=>{alert("우편번호 검색 기능은 아직 구현되지 않았습니다.")},_=async()=>{u.showModal("회원탈퇴","정말 회원 탈퇴를 진행하시겠습니까?","","확인",()=>{x()})},x=async()=>{try{await c.delete(`http://localhost:8081/api/v1/userinfo/${i.value}`),w.showModal("회원탈퇴","회원 탈퇴가 완료되었습니다."),setTimeout(()=>{window.location.href="/"},3e3)}catch(t){console.error("Error deleting account:",t),u.showModal("회원탈퇴","회원정보 업데이트에 실패했습니다. ","","확인")}};return(t,e)=>(b(),y(j,null,[s("div",z,[s("div",F,[s("div",T,[s("form",{onSubmit:N(U,["prevent"])},[e[18]||(e[18]=s("div",{class:"section-title"},"회원정보 관리",-1)),s("div",O,[s("div",R,[e[10]||(e[10]=s("label",{for:"user-id"},"아이디",-1)),s("input",{id:"user-id",type:"text",value:o.value.userUuid,readonly:""},null,8,q)]),s("div",G,[e[11]||(e[11]=s("label",{for:"password"},"비밀번호",-1)),s("div",H,[r(s("input",{id:"password",type:"password","onUpdate:modelValue":e[0]||(e[0]=a=>o.value.password=a),readonly:""},null,512),[[n,o.value.password]]),s("button",{type:"button",class:"btn-password-change",onClick:M}," 변경하기 ")])]),s("div",J,[e[12]||(e[12]=s("label",{for:"name"},"이름",-1)),r(s("input",{id:"name",type:"text","onUpdate:modelValue":e[1]||(e[1]=a=>o.value.userName=a),readonly:""},null,512),[[n,o.value.userName]])]),s("div",K,[e[13]||(e[13]=s("label",{for:"phone"},"휴대폰 번호",-1)),r(s("input",{id:"phone",type:"text","onUpdate:modelValue":e[2]||(e[2]=a=>o.value.phone=a)},null,512),[[n,o.value.phone]])]),s("div",L,[e[14]||(e[14]=s("label",{for:"birthdate"},"생년월일",-1)),r(s("input",{id:"birthdate",type:"date","onUpdate:modelValue":e[3]||(e[3]=a=>o.value.birthDate=a)},null,512),[[n,o.value.birthDate]])]),s("div",Q,[e[15]||(e[15]=s("label",{for:"email"},"이메일 주소",-1)),s("div",W,[r(s("input",{id:"email",type:"email","onUpdate:modelValue":e[4]||(e[4]=a=>o.value.email=a)},null,512),[[n,o.value.email]]),s("button",{type:"button",class:"btn-email-check",onClick:E}," 중복확인 ")]),s("span",{id:"email-check-result",class:B({"success-message":!l.value.isError,"error-message":l.value.isError})},I(l.value.message),3)]),s("div",X,[e[16]||(e[16]=s("label",null,"주소 정보",-1)),s("div",Y,[r(s("input",{type:"text",id:"user_address","onUpdate:modelValue":e[5]||(e[5]=a=>o.value.address=a)},null,512),[[n,o.value.address]]),s("button",{type:"button",class:"btn-postcode-search",onClick:V,id:"addressSearch"}," 우편번호 검색 ")]),r(s("input",{type:"text",class:"hidden-input",id:"user_detail_address","onUpdate:modelValue":e[6]||(e[6]=a=>o.value.detailAddress=a)},null,512),[[n,o.value.detailAddress]]),s("input",{type:"text",id:"user_total_address",name:"address",style:{display:"none"},value:o.value.address+" "+o.value.detailAddress},null,8,Z)]),e[17]||(e[17]=s("div",{class:"button-group"},[s("button",{type:"submit",class:"btn-save",id:"updateBtn"}," 수정완료 ")],-1)),s("div",{class:"withdrawal-group"},[s("button",{type:"button",class:"btn-withdrawal",onClick:_}," 회원 탈퇴 ")])])],32)])])]),f.value?(b(),y("div",ss,[s("div",es,[e[22]||(e[22]=s("span",{class:"modal-title"},"비밀번호 변경",-1)),e[23]||(e[23]=s("span",{class:"modal-subtitle"},"변경하실 비밀번호를 입력해주세요",-1)),s("div",os,[e[19]||(e[19]=s("h3",{class:"modal-current-password"},[s("span",null,"현재 비밀번호")],-1)),s("div",as,[r(s("input",{type:"password",id:"current-password-change","onUpdate:modelValue":e[7]||(e[7]=a=>m.value=a),placeholder:"현재 비밀번호를 입력하세요"},null,512),[[n,m.value]])]),e[20]||(e[20]=s("h4",{class:"modal-new-password"},[s("span",null,"새 비밀번호")],-1)),s("div",ts,[r(s("input",{type:"password",id:"new-password","onUpdate:modelValue":e[8]||(e[8]=a=>p.value=a),placeholder:"새 비밀번호를 입력하세요"},null,512),[[n,p.value]])]),e[21]||(e[21]=s("h5",{class:"modal-confirm-password"},[s("span",null,"새 비밀번호 확인")],-1)),s("div",ls,[r(s("input",{type:"password",id:"confirm-password","onUpdate:modelValue":e[9]||(e[9]=a=>v.value=a),placeholder:"한번 더 입력하세요"},null,512),[[n,v.value]])])]),s("div",{class:"modal-footer"},[s("button",{onClick:k},"비밀번호 변경하기"),s("button",{onClick:h},"취소")])])])):$("",!0)],64))}},is=C(rs,[["__scopeId","data-v-a24e3e60"]]);export{is as default};
