import{D as E,j as x,r as v,o as Q,c as q,b as c,d as t,t as l,x as z,I as F,F as y,g as S,m as p,A as b,f as j,p as u,n as O,a as f,i as r}from"./index-DOioujxJ.js";import{_ as G}from"./close-button-yhCBxJER.js";import{r as M,f as P,g as N}from"./firebaseConfig-Cr89vwH1.js";import H from"./ReviewView-DsmBf5EI.js";const J={class:"container"},K={class:"image-section"},W=["src"],X={class:"details-section"},Y={class:"brand"},Z={class:"product-title"},tt={class:"price-section"},et={key:0,class:"price"},st={key:1},ot={class:"quantity-section"},at=["value"],lt={key:0,class:"selected-summary-info"},nt={class:"selected-summary"},it={class:"pick-block"},ct={style:{"font-size":"1.5em"}},rt={class:"buttons"},dt=["disabled"],ut=["disabled"],vt={class:"container2"},_t={class:"container"},pt={class:"tab-section"},mt={class:"container"},bt={key:0,class:"tab-content",id:"details"},ht=["src","alt"],yt={key:1,class:"tab-content",id:"reviews"},ft={key:2,class:"tab-content",id:"qna"},kt={key:3,class:"tab-content",id:"seller"},wt={class:"bottom-fixed-bar"},gt={class:"product-info"},$t=["src"],Ct={class:"product-description"},It={class:"product-description"},qt={class:"quantity-section"},St={class:"total-price"},Mt={class:"buttons"},Pt=["disabled"],Nt=["disabled"],At={key:0,class:"modal"},Rt={class:"modal-content"},Ut={class:"modal-actions"},A="/api/products",xt={__name:"ProductView",setup(Lt){var I;const n=E(),R=(I=x().user)==null?void 0:I.userId,i=v("details"),d=v({});v([]);const U=O(),_=v(U.params.productId),h=v(""),k=v([]),L=async()=>{try{const a=M(P,`lookkit/products/0${_.value}/${_.value}_thumbnail.webp`);h.value=await N(a);for(let e=1;e<=6;e++)try{const s=M(P,`lookkit/products/0${_.value}/${_.value}_detail_${e}.webp`),m=await N(s);k.value.push(m)}catch(s){console.log(`디테일 이미지 ${e} 가져오기 실패 (존재하지 않을 수 있음)`,s)}}catch(a){console.error("이미지 가져오기 실패:",a)}},B=async()=>{try{const a=await f.get(`${A}/${_.value}`);d.value=a.data}catch(a){console.error("상품 데이터를 불러오는데 실패했습니다.",a)}};Q(()=>{B(),L()});const o=v(0),w=q(()=>d.value.productPrice*o.value),g=q(()=>`${w.value?w.value.toLocaleString():"0"}원`),V=()=>{o.value=0},T=async()=>{try{const e=await f.post(`/api/cart/add/product/${d.value.productId}?quantity=${o.value}&userId=${R}`);window.location.href="/cart"}catch(a){console.error("옷장에 추가 실패:",a),alert("장바구니에 추가하는 데 실패했습니다.")}},$=()=>{if(o.value===0){alert("수량을 선택해주세요.");return}n.showModal("장바구니 담기","이 상품을 장바구니에 담으시겠습니까?","","장바구니 담기",()=>{n.closeModal(),T()})},D=async()=>{try{const e=(await f.post(`${A}/buy?productId=${d.value.productId}&quantity=${o.value}`)).data,s=new URLSearchParams({itemId:e.itemId,itemName:e.itemName,brandName:e.brandName,quantity:e.quantity,price:e.price,totalPrice:e.totalPrice,itemType:"product"});window.location.href=`/order?${s.toString()}`}catch(a){alert("구매 페이지로 이동하는 데 실패했습니다."),console.error("주문 오류:",a)}},C=()=>{if(o.value===0){alert("수량을 선택해주세요.");return}n.showModal("구매하기","이 상품을 구매하시겠습니까?","","구매",()=>{n.closeModal(),D()})};return(a,e)=>(r(),c(y,null,[t("div",J,[t("div",K,[t("img",{src:h.value,alt:"상품 썸네일"},null,8,W)]),t("div",X,[t("div",null,[t("div",Y,l(d.value.brandName),1),t("div",Z,l(d.value.productName),1),t("div",tt,[d.value.productPrice!==void 0?(r(),c("span",et,l(d.value.productPrice.toLocaleString())+"원",1)):(r(),c("span",st,"가격 정보 없음"))]),t("div",ot,[e[7]||(e[7]=t("label",{for:"quantity",class:"quantity-label"},"수량",-1)),z(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.value=s),id:"quantity",class:"quantity-select"},[(r(),c(y,null,S(10,s=>t("option",{key:s,value:s-1},l(s-1),9,at)),64))],512),[[F,o.value,void 0,{number:!0}]])]),o.value>0?(r(),c("div",lt,[t("div",nt,[t("div",it,[t("p",null,"선택한 수량 "+l(o.value)+"개",1),t("img",{src:G,onClick:V,class:"cancel-button"})]),t("p",null,[t("strong",ct,"총 구매 금액: "+l(g.value),1)])])])):p("",!0)]),t("div",rt,[t("button",{onClick:$,disabled:o.value===0,class:"btn btn-cart"}," 장바구니 ",8,dt),t("button",{onClick:C,disabled:o.value===0,class:"btn btn-buy"}," 구매하기 ",8,ut)])])]),t("div",vt,[t("div",_t,[t("div",pt,[t("div",{class:b({active:i.value==="details"}),onClick:e[1]||(e[1]=s=>i.value="details")}," 상세정보 ",2),t("div",{class:b({active:i.value==="reviews"}),onClick:e[2]||(e[2]=s=>i.value="reviews")}," 리뷰 ",2),t("div",{class:b({active:i.value==="qna"}),onClick:e[3]||(e[3]=s=>i.value="qna")}," 상품 Q&A ",2),t("div",{class:b({active:i.value==="seller"}),onClick:e[4]||(e[4]=s=>i.value="seller")}," 판매자 정보 ",2)])]),t("div",mt,[i.value==="details"?(r(),c("div",bt,[(r(!0),c(y,null,S(k.value,(s,m)=>(r(),c("div",{key:m},[t("img",{src:s,alt:"상품사진"+(m+1)},null,8,ht)]))),128))])):p("",!0),i.value==="reviews"?(r(),c("div",yt,[j(H,{productId:_.value},null,8,["productId"])])):p("",!0),i.value==="qna"?(r(),c("div",ft,e[8]||(e[8]=[t("p",null,"상품 Q&A 내용이 여기에 표시됩니다.",-1)]))):p("",!0),i.value==="seller"?(r(),c("div",kt,e[9]||(e[9]=[t("p",null,"판매자 정보가 여기에 표시됩니다.",-1)]))):p("",!0)])]),t("div",wt,[t("div",gt,[t("img",{src:h.value,alt:"상품 이미지"},null,8,$t),t("div",null,[t("div",Ct,l(d.value.brandName),1),t("div",It,l(d.value.productName),1)])]),t("div",qt,[t("p",null,"선택한 수량 "+l(o.value)+"개",1)]),t("div",St,"총 상품 금액 "+l(g.value),1),t("div",Mt,[t("button",{onClick:$,disabled:o.value===0,class:"btn btn-cart"}," 장바구니 ",8,Pt),t("button",{onClick:C,disabled:o.value===0,class:"btn btn-buy"}," 구매하기 ",8,Nt)])]),u(n).isModalVisible?(r(),c("div",At,[t("div",Rt,[t("h3",null,l(u(n).modalActionMessage),1),t("p",null,l(u(n).questionMessage),1),t("p",null,l(u(n).warningMessage),1),t("div",Ut,[t("button",{onClick:e[5]||(e[5]=(...s)=>u(n).confirmCallback&&u(n).confirmCallback(...s))},"확인"),t("button",{onClick:e[6]||(e[6]=(...s)=>u(n).closeModal&&u(n).closeModal(...s))},"취소")])])])):p("",!0)],64))}};export{xt as default};
