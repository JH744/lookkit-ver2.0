import{_ as L,j as R,L as $,r as u,b as a,d as t,s as S,m as y,v,x as _,F,g as x,i as r,a as D,$ as E}from"./index-D7EuPnGH.js";import{_ as B}from"./add_img-CGArnYmR.js";import{r as V,f as j,u as M,g as N}from"./firebaseConfig-Cr89vwH1.js";const T={class:"inquiry-form"},A={class:"form-title"},O={class:"inquiry-inline"},P={key:0,class:"error-message"},z={class:"form-content"},G={class:"inquiry-inline"},H={key:0,class:"error-message"},J={class:"image-upload"},K=["onClick"],Q=["onChange"],W={key:0,class:"plus-text"},X=["src"],Y={__name:"InquiryForm",setup(Z){const h=R(),l=$({title:"",content:"",imageFile:[]}),p=u(!1),d=u(!1),g=u([]),m=u(null),c=u([null,null,null]),q=n=>{const e=g.value[n];e&&e.click()},b=()=>{m.value&&m.value.click()},k=(n,e)=>{const s=n.target.files[0];s&&(l.imageFile[e]=s,c.value[e]=URL.createObjectURL(s))},I=n=>{const e=Array.from(n.target.files);if(e.length>3){alert("사진은 최대 3개까지만 업로드 가능합니다.");return}l.imageFile=[],c.value=[null,null,null],e.forEach((s,i)=>{i<3&&(l.imageFile[i]=s,c.value[i]=URL.createObjectURL(s))})},C=async()=>{if(p.value=!l.title,d.value=!l.content,!p.value&&!d.value)try{const n=await w(),e={userId:h.user.userId,inquiryTitle:l.title,inquiryContents:l.content,imageUrls:n},s=await D.post("http://localhost:8081/api/mypage/inquiry",e);E.push({name:"InquiryDetail",params:{inquiryId:s.data.data.inquiryId}})}catch(n){console.log("문의 등록 중 오류:",n)}},w=async()=>{const n=[];for(let e=0;e<l.imageFile.length;e++)if(l.imageFile[e]){const s=l.imageFile[e],i=`${Date.now()}-${s.name}`,o=V(j,`uploads/inquiry/${i}`);try{await M(o,s);const f=await N(o);n.push(f)}catch(f){console.error(`Error uploading image ${s.name}:`,f)}}return n},U=()=>{history.back()};return(n,e)=>(r(),a(F,null,[e[8]||(e[8]=t("section",{class:"section-inquiries"},[t("p",null,"1:1 문의하기"),t("p",null,"한번 등록한 상담내용은 수정이 불가능합니다.")],-1)),t("div",T,[t("form",{onSubmit:S(C,["prevent"]),enctype:"multipart/form-data"},[t("div",A,[t("div",O,[e[2]||(e[2]=t("p",{class:"inquiry-content-title"},"문의 제목",-1)),p.value?(r(),a("p",P,"문의명을 입력해주세요")):y("",!0)]),v(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>l.title=s),class:"input-title",placeholder:"문의명을 입력하세요",required:""},null,512),[[_,l.title]])]),t("div",z,[t("div",G,[e[3]||(e[3]=t("p",{class:"inquiry-content-title"},"문의 내용",-1)),d.value?(r(),a("p",H,"내용을 입력해 주세요")):y("",!0)]),v(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.content=s),class:"input-content",placeholder:"문의 내용은 2,000자 이내로 입력하세요",required:""},null,512),[[_,l.content]])]),t("div",J,[(r(!0),a(F,null,x(c.value,(s,i)=>(r(),a("div",{key:i,class:"image-placeholder",onClick:o=>q(i)},[t("input",{ref_for:!0,ref:o=>g.value[i]=o,style:{display:"none"},type:"file",accept:"image/*",onChange:o=>k(o,i)},null,40,Q),s?(r(),a("img",{key:1,src:s},null,8,X)):(r(),a("div",W,"+"))],8,K))),128)),t("div",{class:"upload-button",onClick:b},[t("input",{type:"file",ref_key:"multipleFileInput",ref:m,style:{display:"none"},accept:"image/*",multiple:"",onChange:I},null,544),e[4]||(e[4]=t("img",{class:"upload-icon",src:B},null,-1)),e[5]||(e[5]=t("span",{class:"upload-text"},"여러장 선택하기",-1))])]),t("div",{class:"button-group"},[e[6]||(e[6]=t("button",{type:"submit",class:"btn-submit"},"등록하기",-1)),t("div",{class:"btn-cancel",onClick:U},"취소하기")])],32),e[7]||(e[7]=t("div",{class:"notice"},[t("div",{class:"notice-icon-block"},[t("p",{class:"notice-icon"},"!"),t("span",null,"유의사항")]),t("div",{class:"notice-text"},[t("ul",null,[t("li",null,"개인정보를 남기면 타인에 의해 도용될 수 있으니 문의하기 작성 시 주의해주세요"),t("li",null,"사진은 최대 3개까지 업로드 가능합니다")])])],-1))])],64))}},le=L(Y,[["__scopeId","data-v-d9b06e40"]]);export{le as default};
