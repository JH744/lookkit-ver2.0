import{C as E,j as x,r as v,o as z,c as q,b as c,d as t,t as l,v as Q,H as F,F as y,g as S,m as p,z as b,f as j,p as u,n as H,a as f,i as r}from"./index-D7EuPnGH.js";import{_ as O}from"./close-button-yhCBxJER.js";import{r as M,f as P,g as N}from"./firebaseConfig-Cr89vwH1.js";import G from"./ReviewView-CQc_A7ya.js";const J={class:"container"},K={class:"image-section"},W=["src"],X={class:"details-section"},Y={class:"brand"},Z={class:"product-title"},tt={class:"price-section"},st={key:0,class:"price"},et={key:1},ot={class:"quantity-section"},at=["value"],lt={key:0,class:"selected-summary-info"},nt={class:"selected-summary"},it={class:"pick-block"},ct={style:{"font-size":"1.5em"}},rt={class:"buttons"},dt=["disabled"],ut=["disabled"],vt={class:"container2"},_t={class:"container"},pt={class:"tab-section"},mt={class:"container"},bt={key:0,class:"tab-content",id:"details"},ht=["src","alt"],yt={key:1,class:"tab-content",id:"reviews"},ft={key:2,class:"tab-content",id:"qna"},kt={key:3,class:"tab-content",id:"seller"},wt={class:"bottom-fixed-bar"},gt={class:"product-info"},$t=["src"],Ct={class:"product-description"},It={class:"product-description"},qt={class:"quantity-section"},St={class:"total-price"},Mt={class:"buttons"},Pt=["disabled"],Nt=["disabled"],At={key:0,class:"modal"},Rt={class:"modal-content"},Ut={class:"modal-actions"},A="http://localhost:8081/api/products",xt={__name:"ProductView",setup(Lt){var I;const n=E(),R=(I=x().user)==null?void 0:I.userId,i=v("details"),d=v({});v([]);const U=H(),_=v(U.params.productId),h=v(""),k=v([]),L=async()=>{try{const a=M(P,`lookkit/products/0${_.value}/${_.value}_thumbnail.webp`);h.value=await N(a);for(let s=1;s<=6;s++)try{const e=M(P,`lookkit/products/0${_.value}/${_.value}_detail_${s}.webp`),m=await N(e);k.value.push(m)}catch(e){console.log(`디테일 이미지 ${s} 가져오기 실패 (존재하지 않을 수 있음)`,e)}}catch(a){console.error("이미지 가져오기 실패:",a)}},B=async()=>{try{const a=await f.get(`${A}/${_.value}`);d.value=a.data}catch(a){console.error("상품 데이터를 불러오는데 실패했습니다.",a)}};z(()=>{B(),L()});const o=v(0),w=q(()=>d.value.productPrice*o.value),g=q(()=>`${w.value?w.value.toLocaleString():"0"}원`),V=()=>{o.value=0},T=async()=>{try{const s=await f.post(`http://localhost:8081/api/cart/add/product/${d.value.productId}?quantity=${o.value}&userId=${R}`);window.location.href="/cart"}catch(a){console.error("옷장에 추가 실패:",a),alert("장바구니에 추가하는 데 실패했습니다.")}},$=()=>{if(o.value===0){alert("수량을 선택해주세요.");return}n.showModal("장바구니 담기","이 상품을 장바구니에 담으시겠습니까?","","장바구니 담기",()=>{n.closeModal(),T()})},D=async()=>{try{const s=(await f.post(`${A}/buy?productId=${d.value.productId}&quantity=${o.value}`)).data,e=new URLSearchParams({itemId:s.itemId,itemName:s.itemName,brandName:s.brandName,quantity:s.quantity,price:s.price,totalPrice:s.totalPrice,itemType:"product"});window.location.href=`/order?${e.toString()}`}catch(a){alert("구매 페이지로 이동하는 데 실패했습니다."),console.error("주문 오류:",a)}},C=()=>{if(o.value===0){alert("수량을 선택해주세요.");return}n.showModal("구매하기","이 상품을 구매하시겠습니까?","","구매",()=>{n.closeModal(),D()})};return(a,s)=>(r(),c(y,null,[t("div",J,[t("div",K,[t("img",{src:h.value,alt:"상품 썸네일"},null,8,W)]),t("div",X,[t("div",null,[t("div",Y,l(d.value.brandName),1),t("div",Z,l(d.value.productName),1),t("div",tt,[d.value.productPrice!==void 0?(r(),c("span",st,l(d.value.productPrice.toLocaleString())+"원",1)):(r(),c("span",et,"가격 정보 없음"))]),t("div",ot,[s[7]||(s[7]=t("label",{for:"quantity",class:"quantity-label"},"수량",-1)),Q(t("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>o.value=e),id:"quantity",class:"quantity-select"},[(r(),c(y,null,S(10,e=>t("option",{key:e,value:e-1},l(e-1),9,at)),64))],512),[[F,o.value,void 0,{number:!0}]])]),o.value>0?(r(),c("div",lt,[t("div",nt,[t("div",it,[t("p",null,"선택한 수량 "+l(o.value)+"개",1),t("img",{src:O,onClick:V,class:"cancel-button"})]),t("p",null,[t("strong",ct,"총 구매 금액: "+l(g.value),1)])])])):p("",!0)]),t("div",rt,[t("button",{onClick:$,disabled:o.value===0,class:"btn btn-cart"},"장바구니",8,dt),t("button",{onClick:C,disabled:o.value===0,class:"btn btn-buy"},"구매하기",8,ut)])])]),t("div",vt,[t("div",_t,[t("div",pt,[t("div",{class:b({active:i.value==="details"}),onClick:s[1]||(s[1]=e=>i.value="details")},"상세정보",2),t("div",{class:b({active:i.value==="reviews"}),onClick:s[2]||(s[2]=e=>i.value="reviews")},"리뷰",2),t("div",{class:b({active:i.value==="qna"}),onClick:s[3]||(s[3]=e=>i.value="qna")},"상품 Q&A",2),t("div",{class:b({active:i.value==="seller"}),onClick:s[4]||(s[4]=e=>i.value="seller")},"판매자 정보",2)])]),t("div",mt,[i.value==="details"?(r(),c("div",bt,[(r(!0),c(y,null,S(k.value,(e,m)=>(r(),c("div",{key:m},[t("img",{src:e,alt:"상품사진"+(m+1)},null,8,ht)]))),128))])):p("",!0),i.value==="reviews"?(r(),c("div",yt,[j(G,{productId:_.value},null,8,["productId"])])):p("",!0),i.value==="qna"?(r(),c("div",ft,s[8]||(s[8]=[t("p",null,"상품 Q&A 내용이 여기에 표시됩니다.",-1)]))):p("",!0),i.value==="seller"?(r(),c("div",kt,s[9]||(s[9]=[t("p",null,"판매자 정보가 여기에 표시됩니다.",-1)]))):p("",!0)])]),t("div",wt,[t("div",gt,[t("img",{src:h.value,alt:"상품 이미지"},null,8,$t),t("div",null,[t("div",Ct,l(d.value.brandName),1),t("div",It,l(d.value.productName),1)])]),t("div",qt,[t("p",null,"선택한 수량 "+l(o.value)+"개",1)]),t("div",St,"총 상품 금액 "+l(g.value),1),t("div",Mt,[t("button",{onClick:$,disabled:o.value===0,class:"btn btn-cart"},"장바구니",8,Pt),t("button",{onClick:C,disabled:o.value===0,class:"btn btn-buy"},"구매하기",8,Nt)])]),u(n).isModalVisible?(r(),c("div",At,[t("div",Rt,[t("h3",null,l(u(n).modalActionMessage),1),t("p",null,l(u(n).questionMessage),1),t("p",null,l(u(n).warningMessage),1),t("div",Ut,[t("button",{onClick:s[5]||(s[5]=(...e)=>u(n).confirmCallback&&u(n).confirmCallback(...e))},"확인"),t("button",{onClick:s[6]||(s[6]=(...e)=>u(n).closeModal&&u(n).closeModal(...e))},"취소")])])])):p("",!0)],64))}};export{xt as default};
